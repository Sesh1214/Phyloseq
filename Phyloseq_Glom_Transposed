library(readxl)
library(readr)
library(ggplot2)
library(ggplot)
library(phyloseq)
#The files used in this are transposed from the original so that the species/genus/class etc are rows - hence the taxa_are_rows=TRUE argument
metadata <- read.table("/Users/seshadhrisubramanian/Desktop/Experimental Data/16s_Progression_Data.tsv", sep="\t", header=TRUE, row.names=1)
str(metadata)
otu <- read.table("/Users/seshadhrisubramanian/Desktop/Experimental Data/16s_Community.tsv", sep="\t", header=TRUE, row.names=1)
str(otu)
library(dplyr)
otu <- otu %>% mutate(across(where(is.character), as.numeric))
taxa <- tax_table(otu)
taxa_names(taxa)
ps <- phyloseq(otu_table(otu, taxa_are_rows=TRUE), tax_table(taxa), sample_data(metadata))
ps_phylum <- tax_glom(ps, "ta1")
p1 <- plot_bar(ps_phylum, fill = "ta1")
p1
